INPUT(N1)
INPUT(N2)
INPUT(N3)
INPUT(N6)
INPUT(N7)
INPUT(key0)
INPUT(key1)

OUTPUT(N22)
OUTPUT(N23)

N10 = NAND(N1, N3)
N11 = NAND(N3, N6)
N16 = NAND(N2, N11enc)
N19 = NAND(N11enc, N7)
N22 = NAND(N10, N16)
N23 = NAND(N11enc, N16, N19enc)

N11enc = XOR(N11,key0)
N19enc = XOR(N19,key1)